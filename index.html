<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Mon Livre PDF</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { background: #111; color: #fff; font-family: system-ui,-apple-system,BlinkMacSystemFont,sans-serif; margin:0; padding:0; }
    h1 { text-align:center; margin:16px 0; }
    #viewer { display:flex; flex-direction:column; align-items:center; gap:16px; padding:8px; }
    canvas { box-shadow: 0 4px 16px rgba(0,0,0,0.5); max-width:90%; height:auto; }
    .nav { display:flex; justify-content:center; gap:12px; margin-bottom:8px; }
    button { padding:8px 16px; background:#444; border:none; color:#fff; cursor:pointer; border-radius:4px; }
    button:disabled { opacity:.5; cursor:default; }
  </style>
</head>
<body>
  <h1>Mon Livre PDF</h1>
  <div class="nav">
    <button id="prev">« Précédent</button>
    <button id="next">Suivant »</button>
    <span id="status">Chargement...</span>
  </div>
  <div id="viewer"></div>

  <!-- pdf.js depuis CDN (version stable) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js" integrity="sha512-BQSZfGxe0spUq9pIb1D97Glc6jF3fJmP5F3kqXyHdHef2X4DqGZG/KR9M9vN6MfFJv43VFr+JfmQpDqO72Y4g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    // Indiquer où est le worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js';

    const url = 'pdf/livre.pdf'; // chemin relatif dans ton repo
    const viewer = document.getElementById('viewer');
    const status = document.getElementById('status');
    let pdfDoc = null;
    let currentPage = 1;
    const scale = 1.2; // tu peux ajuster

    async function renderPage(pageNum) {
      status.textContent = `Affichage de la page ${pageNum} / ${pdfDoc.numPages}`;
      viewer.innerHTML = ''; // effacer l'ancien rendu
      const page = await pdfDoc.getPage(pageNum);
      const viewport = page.getViewport({ scale });
      const canvas = document.createElement('canvas');
      const context = canvas.getContext('2d');
      canvas.width = viewport.width;
      canvas.height = viewport.height;
      viewer.appendChild(canvas);
      await page.render({ canvasContext: context, viewport }).promise;
    }

    async function loadPDF() {
      try {
        const loading = pdfjsLib.getDocument(url);
        pdfDoc = await loading.promise;
        status.textContent = 'PDF chargé.';
        renderPage(currentPage);
      } catch (e) {
        status.textContent = 'Erreur de chargement du PDF: ' + e.message;
        console.error(e);
      }
    }

    document.getElementById('prev').addEventListener('click', () => {
      if (currentPage <= 1) return;
      currentPage--;
      renderPage(currentPage);
    });
    document.getElementById('next').addEventListener('click', () => {
      if (currentPage >= pdfDoc.numPages) return;
      currentPage++;
      renderPage(currentPage);
    });

    loadPDF();
  </script>
</body>
</html>
