<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Mon Livre PDF – Flipbook</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<style>
  body{margin:0;background:#111;color:#fff;font-family:system-ui,sans-serif;overflow:hidden}
  h1{text-align:center;margin:10px 0;font-size:clamp(22px,6vw,38px)}
  .bar{display:flex;justify-content:center;gap:8px;margin-bottom:4px;flex-wrap:wrap}
  button{padding:8px 16px;background:#444;border:none;color:#fff;border-radius:5px;cursor:pointer;font-size:15px}
  button:disabled{opacity:.4;cursor:not-allowed}
  #status{margin-left:6px;align-self:center;white-space:nowrap}
  #container{display:flex;justify-content:center;height:calc(100vh - 110px)}
  #flipbook{background:#222;display:none}
  canvas{background:#fff}
  :fullscreen #flipbook{width:100vw!important;height:100vh!important}
</style>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- turn.js local -->
<script src="libs/turn.min.js"></script>
<!-- pdf.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js"></script>
</head>
<body>

<h1>Mon Livre PDF</h1>
<div class="bar">
  <button id="prev" disabled>« Précédent</button>
  <button id="next" disabled>Suivant »</button>
  <button id="fs">Plein écran ⤢</button>
  <span  id="status">Chargement…</span>
</div>

<div id="container"><div id="flipbook"></div></div>

<script>
/* ------------- config ------------- */
const PDF_URL = 'pdf/livre.pdf';          // chemin de ton PDF
/* ---------------------------------- */

pdfjsLib.GlobalWorkerOptions.workerSrc =
 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js';

const flip     = $('#flipbook'),
      statusEl = $('#status'),
      prevBtn  = $('#prev'),
      nextBtn  = $('#next'),
      fsBtn    = $('#fs');

let pdfDoc,totalPages,zoom=1;

/* double page si large : ≥ 768 px ou orientation paysage */
function doubleMode(){
  return window.innerWidth >= 768 || window.matchMedia('(orientation: landscape)').matches;
}

/* ——— ÉCHELLE ——— */
function scaleFor(vp){
  const header = document.querySelector('.bar').offsetHeight + 40;
  const availW = window.innerWidth  - 32;          // marges
  const availH = window.innerHeight - header;
  const pages  = doubleMode() ? 2 : 1;

  const byW = (availW / pages) / vp.width;
  const byH =  availH            / vp.height;

  /* 1 page en portrait → remplir en largeur ; 2 pages → min(byW,byH) */
  return (pages === 1 ? byW : Math.min(byW,byH)) * zoom;
}

/* canvas d’une page */
async function renderPage(n){
  const page = await pdfDoc.getPage(n);
  const vp0  = page.getViewport({scale:1});
  const sc   = scaleFor(vp0);
  const vp   = page.getViewport({scale:sc});
  const c    = document.createElement('canvas');
  c.width  = vp.width;
  c.height = vp.height;
  await page.render({canvasContext:c.getContext('2d'),viewport:vp}).promise;
  return c;
}

/* (re)
